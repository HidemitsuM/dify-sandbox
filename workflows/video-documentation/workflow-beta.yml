app:
  description: å‹•ç”»ã‹ã‚‰è‡ªå‹•çš„ã«ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ç”Ÿæˆã™ã‚‹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼Betaç‰ˆã€‚è¿½åŠ ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆã‚¹ãƒ©ã‚¤ãƒ‰ã€ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆç­‰ï¼‰ã‚’æŠ•å…¥å¯èƒ½ã§ã€äº‹å®Ÿç¢ºèªãƒ»ç²¾åº¦å‘ä¸Šã‚’è¡Œã„ã¾ã™ã€‚
  icon: ğŸ¬
  icon_background: '#6366F1'
  mode: workflow
  name: Video Documentation Workflow Beta
  use_icon_as_answer_icon: false

kind: app
version: 0.1.2

workflow:
  environment_variables: []
  conversation_variables: []
  features:
    file_upload:
      image:
        enabled: true
    opening_statement: å‹•ç”»ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã¨ã€è‡ªå‹•çš„ã«ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚’æŠ½å‡ºã—ã€æ–‡å­—èµ·ã“ã—ã¨ç”»åƒåˆ†æã‚’è¡Œã£ã¦ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ç”Ÿæˆã—ã¾ã™ã€‚ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§è¿½åŠ ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆã‚¹ãƒ©ã‚¤ãƒ‰ã€ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆç­‰ï¼‰ã‚’æŠ•å…¥å¯èƒ½ã§ã™ã€‚
    retriever_resource:
      enabled: false
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions:
      - ã©ã®ãã‚‰ã„ã®æ™‚é–“ã§å‡¦ç†ãŒå®Œäº†ã—ã¾ã™ã‹ï¼Ÿ
      - å¯¾å¿œã—ã¦ã„ã‚‹å‹•ç”»å½¢å¼ã¯ä½•ã§ã™ã‹ï¼Ÿ
      - é‡è¦åº¦ã‚¹ã‚³ã‚¢ã¯ã©ã®ã‚ˆã†ã«è¨ˆç®—ã•ã‚Œã¾ã™ã‹ï¼Ÿ
      - è¿½åŠ ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã©ã®ã‚ˆã†ã«å‡¦ç†ã•ã‚Œã¾ã™ã‹ï¼Ÿ
    text_to_speech:
      enabled: false
      language: ''
      voice: ''

  graph:
    edges:
      # Start -> Code Node 1 (Video Processing)
      - source: '1770557302578'
        sourceHandle: source
        target: '1770557302678'
        targetHandle: target
        type: custom
        data:
          sourceType: start
          targetType: code
          isInIteration: false

      # Code Node 1 -> LLM Node 1 (Transcription)
      - source: '1770557302678'
        sourceHandle: audio_file
        target: '1770557302778'
        targetHandle: target
        type: custom
        data:
          sourceType: code
          targetType: llm
          isInIteration: false

      # Code Node 1 -> Code Node 2 (Data Linking)
      - source: '1770557302678'
        sourceHandle: snapshots
        target: '1770557302878'
        targetHandle: target
        type: custom
        data:
          sourceType: code
          targetType: code
          isInIteration: false

      # LLM Node 1 -> Code Node 2 (Data Linking)
      - source: '1770557302778'
        sourceHandle: source
        target: '1770557302878'
        targetHandle: transcript
        type: custom
        data:
          sourceType: llm
          targetType: code
          isInIteration: false

      # Code Node 2 -> Code Node 3 (Batch Splitting)
      - source: '1770557302878'
        sourceHandle: source
        target: '1770557302978'
        targetHandle: target
        type: custom
        data:
          sourceType: code
          targetType: code
          isInIteration: false

      # Code Node 3 -> Iteration Node
      - source: '1770557302978'
        sourceHandle: source
        target: '1770557303078'
        targetHandle: target
        type: custom
        data:
          sourceType: code
          targetType: iteration
          isInIteration: false

      # Iteration Node -> LLM Node 2 (Image Analysis)
      - source: '1770557303078'
        sourceHandle: source
        target: '1770557303178'
        targetHandle: target
        type: custom
        data:
          sourceType: iteration
          targetType: llm
          isInIteration: true

      # LLM Node 2 -> Code Node 4 (Importance Scoring)
      - source: '1770557303178'
        sourceHandle: source
        target: '1770557303278'
        targetHandle: target
        type: custom
        data:
          sourceType: llm
          targetType: code
          isInIteration: true

      # Code Node 4 -> Code Node 5 (Collect Results)
      - source: '1770557303278'
        sourceHandle: source
        target: '1770557303378'
        targetHandle: target
        type: custom
        data:
          sourceType: code
          targetType: code
          isInIteration: true

      # Code Node 5 -> LLM Node 3 (Action Items)
      - source: '1770557303378'
        sourceHandle: source
        target: '1770557303478'
        targetHandle: target
        type: custom
        data:
          sourceType: code
          targetType: llm
          isInIteration: false

      # Code Node 5 -> If-Else Node (Additional Files Check)
      - source: '1770557303378'
        sourceHandle: source
        target: '1770557303679'
        targetHandle: target
        type: custom
        data:
          sourceType: code
          targetType: if-else
          isInIteration: false

      # If-Else (True) -> LLM Node 4 (Additional Files Analysis)
      - source: '1770557303679'
        sourceHandle: 'true'
        target: '1770557303680'
        targetHandle: target
        type: custom
        data:
          sourceType: if-else
          targetType: llm
          isInIteration: false

      # LLM Node 4 -> LLM Node 5 (Fact Verification)
      - source: '1770557303680'
        sourceHandle: source
        target: '1770557303681'
        targetHandle: target
        type: custom
        data:
          sourceType: llm
          targetType: llm
          isInIteration: false

      # LLM Node 5 -> Template Transform Beta
      - source: '1770557303681'
        sourceHandle: source
        target: '1770557303682'
        targetHandle: target
        type: custom
        data:
          sourceType: llm
          targetType: template-transform
          isInIteration: false

      # If-Else (False) -> Template Transform Original
      - source: '1770557303679'
        sourceHandle: 'false'
        target: '1770557303578'
        targetHandle: target
        type: custom
        data:
          sourceType: if-else
          targetType: template-transform
          isInIteration: false

      # LLM Node 3 -> Template Transform Original (when no additional files)
      - source: '1770557303478'
        sourceHandle: source
        target: '1770557303578'
        targetHandle: target
        type: custom
        data:
          sourceType: llm
          targetType: template-transform
          isInIteration: false

      # LLM Node 3 -> Template Transform Beta (when additional files exist)
      - source: '1770557303478'
        sourceHandle: source
        target: '1770557303682'
        targetHandle: action_items
        type: custom
        data:
          sourceType: llm
          targetType: template-transform
          isInIteration: false

      # Template Transform Original -> End Node
      - source: '1770557303578'
        sourceHandle: source
        target: '1770557303678'
        targetHandle: target
        type: custom
        data:
          sourceType: template-transform
          targetType: end
          isInIteration: false

      # Template Transform Beta -> End Node
      - source: '1770557303682'
        sourceHandle: source
        target: '1770557303678'
        targetHandle: target
        type: custom
        data:
          sourceType: template-transform
          targetType: end
          isInIteration: false

    nodes:
      # Start Node (Extended with additional_files)
      - data:
          type: start
          variables:
            - variable: video_file
              type: file
              label: å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«
              required: true
              max_length: 1
            - variable: additional_files
              type: file-list
              label: è¿½åŠ ãƒ•ã‚¡ã‚¤ãƒ«
              required: false
              max_length: 10
            - variable: file_descriptions
              type: paragraph
              label: ãƒ•ã‚¡ã‚¤ãƒ«èª¬æ˜
              required: false
              default: ''
            - variable: interval_seconds
              type: number
              label: ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆé–“éš”ï¼ˆç§’ï¼‰
              required: false
              default: 90
              min: 10
              max: 600
            - variable: context_range
              type: number
              label: ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆç¯„å›²ï¼ˆç§’ï¼‰
              required: false
              default: 30
              min: 10
              max: 120
        id: '1770557302578'
        position:
          x: 80
          y: 200
        type: custom

      # Code Node 1: Video Processing (Audio Extraction + Snapshot Capture)
      - data:
          type: code
          title: å‹•ç”»å‡¦ç†
          code: |
            import cv2
            import base64
            import io
            import os
            from PIL import Image
            from typing import Dict, List, Any
            import subprocess
            import tempfile

            def extract_audio(video_path: str, output_path: str) -> bool:
                '''ffmpegã‚’ä½¿ç”¨ã—ã¦å‹•ç”»ã‹ã‚‰éŸ³å£°ã‚’æŠ½å‡º'''
                try:
                    cmd = [
                        'ffmpeg', '-i', video_path,
                        '-vn', '-acodec', 'pcm_s16le',
                        '-ar', '16000', '-ac', '1',
                        '-y', output_path
                    ]
                    subprocess.run(cmd, capture_output=True, check=True)
                    return True
                except Exception as e:
                    print(f"Audio extraction error: {e}")
                    return False

            def capture_snapshots(video_path: str, interval: int, context_range: int) -> List[Dict[str, Any]]:
                '''æŒ‡å®šã—ãŸé–“éš”ã§ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚’æŠ½å‡º'''
                cap = cv2.VideoCapture(video_path)
                fps = cap.get(cv2.CAP_PROP_FPS)
                total_frames = int(cap.get(cv2.CAP_PROP_FRAME_COUNT))
                duration = total_frames / fps if fps > 0 else 0

                snapshots = []
                timestamp = 0.0
                frame_interval = int(fps * interval)

                frame_count = 0
                while timestamp < duration:
                    cap.set(cv2.CAP_PROP_POS_FRAMES, frame_count)
                    ret, frame = cap.read()

                    if ret:
                        # ç”»åƒã‚’åœ§ç¸®
                        height, width = frame.shape[:2]
                        if width > 1280:
                            scale = 1280 / width
                            new_width = 1280
                            new_height = int(height * scale)
                            frame = cv2.resize(frame, (new_width, new_height))

                        # JPEGå“è³ª85%ã§ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰
                        _, buffer = cv2.imencode('.jpg', frame, [cv2.IMWRITE_JPEG_QUALITY, 85])
                        img_base64 = base64.b64encode(buffer).decode('utf-8')

                        # ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆç¯„å›²ã‚’è¨ˆç®—
                        context_start = max(0, timestamp - context_range)
                        context_end = min(duration, timestamp + context_range)

                        snapshots.append({
                            'timestamp': timestamp,
                            'image_base64': f'data:image/jpeg;base64,{img_base64}',
                            'context_start': context_start,
                            'context_end': context_end
                        })

                    timestamp += interval
                    frame_count += frame_interval

                cap.release()
                return snapshots

            def main(video_file: Dict[str, Any], interval_seconds: int = 90, context_range: int = 30) -> Dict[str, Any]:
                # å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’å–å¾—
                video_path = video_file.get('path', '')

                if not video_path or not os.path.exists(video_path):
                    return {
                        'error': 'å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“',
                        'snapshots': [],
                        'video_duration': 0,
                        'segment_count': 0
                    }

                # å‹•ç”»ã®é•·ã•ã‚’å–å¾—
                cap = cv2.VideoCapture(video_path)
                fps = cap.get(cv2.CAP_PROP_FPS)
                total_frames = int(cap.get(cv2.CAP_PROP_FRAME_COUNT))
                duration = total_frames / fps if fps > 0 else 0
                cap.release()

                # éŸ³å£°ã‚’æŠ½å‡º
                with tempfile.NamedTemporaryFile(suffix='.wav', delete=False) as audio_file:
                    audio_path = audio_file.name

                audio_extracted = extract_audio(video_path, audio_path)

                # ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚’æŠ½å‡º
                snapshots = capture_snapshots(video_path, interval_seconds, context_range)

                return {
                    'snapshots': snapshots,
                    'audio_file': audio_path if audio_extracted else '',
                    'video_duration': duration,
                    'segment_count': len(snapshots)
                }
          outputs:
            - variable: snapshots
              type: array
              label: ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ
            - variable: audio_file
              type: string
              label: éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«
            - variable: video_duration
              type: number
              label: å‹•ç”»é•·ï¼ˆç§’ï¼‰
            - variable: segment_count
              type: number
              label: ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæ•°
          outputs_mapping: {}
        id: '1770557302678'
        position:
          x: 320
          y: 200
        type: custom

      # LLM Node 1: Transcription (Gemini 2.5)
      - data:
          type: llm
          title: æ–‡å­—èµ·ã“ã—
          model:
            provider: google
            name: gemini-2.5-flash
            mode: chat
            completion_params:
              temperature: 0.3
              max_tokens: 32000
          prompt_template:
            - role: system
              text: |
                ã‚ãªãŸã¯éŸ³å£°æ–‡å­—èµ·ã“ã—ã®å°‚é–€å®¶ã§ã™ã€‚æä¾›ã•ã‚ŒãŸéŸ³å£°ã‚’æ­£ç¢ºã«æ–‡å­—èµ·ã“ã—ã—ã¦ãã ã•ã„ã€‚
                ä»¥ä¸‹ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§å‡ºåŠ›ã—ã¦ãã ã•ã„ï¼š
                [HH:MM:SS] ç™ºè¨€å†…å®¹

                ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã¯ç™ºè¨€ã®é–‹å§‹æ™‚åˆ»ã‚’ã€ç™ºè¨€è€…ã‚’ç‰¹å®šã§ãã‚‹å ´åˆã¯ç™ºè¨€è€…åã‚‚å«ã‚ã¦ãã ã•ã„ã€‚
            - role: user
              text: |
                ä»¥ä¸‹ã®éŸ³å£°ã‚’æ–‡å­—èµ·ã“ã—ã¦ãã ã•ã„ã€‚ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã‚’[HH:MM:SS]å½¢å¼ã§å„ç™ºè¨€ã®å…ˆé ­ã«ä»˜ã‘ã¦ãã ã•ã„ã€‚
                è¤‡æ•°ã®è©±è€…ãŒã„ã‚‹å ´åˆã¯ã€è©±è€…ã‚’åŒºåˆ¥ã—ã¦ãã ã•ã„ã€‚
          context:
            enabled: false
            variable_selector: []
          vision:
            enabled: false
          voice:
            enabled: true
            input: '{{#1770557302678.audio_file#}}'
        id: '1770557302778'
        position:
          x: 560
          y: 80
        type: custom

      # Code Node 2: Data Linking (Parse Transcript + Link with Snapshots)
      - data:
          type: code
          title: ãƒ‡ãƒ¼ã‚¿ç´ä»˜ã‘
          code: |
            import re
            from typing import Dict, List, Any
            from datetime import datetime, timedelta

            def parse_transcript(transcript: str) -> List[Dict[str, Any]]:
                '''æ–‡å­—èµ·ã“ã—ã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä»˜ãã®ã‚¨ãƒ³ãƒˆãƒªã«å¤‰æ›'''
                entries = []
                # ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãƒ‘ã‚¿ãƒ¼ãƒ³: [HH:MM:SS] ã¾ãŸã¯ [MM:SS]
                pattern = r'\[(\d{1,2}):(\d{2}):(\d{2})\]\s*(.*?)(?=\n|\[|$)'
                matches = re.findall(pattern, transcript, re.DOTALL)

                for match in matches:
                    hours, minutes, seconds, text = match
                    timestamp = int(hours) * 3600 + int(minutes) * 60 + int(seconds)
                    if text.strip():
                        entries.append({
                            'timestamp': timestamp,
                            'text': text.strip()
                        })

                return entries

            def link_transcript_to_snapshots(snapshots: List[Dict[str, Any]], transcript_entries: List[Dict[str, Any]]) -> List[Dict[str, Any]]:
                '''å„ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã«å¯¾å¿œã™ã‚‹transcriptã‚’ç´ä»˜ã‘'''
                segments = []

                for snapshot in snapshots:
                    context_start = snapshot['context_start']
                    context_end = snapshot['context_end']

                    # ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆç¯„å›²å†…ã®transcriptã‚’æŠ½å‡º
                    context_entries = [
                        entry for entry in transcript_entries
                        if context_start <= entry['timestamp'] <= context_end
                    ]

                    # ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆtranscriptã‚’æ§‹ç¯‰
                    context_transcript = '\n'.join([
                        f"[{format_timestamp(entry['timestamp'])}] {entry['text']}"
                        for entry in context_entries
                    ])

                    segments.append({
                        'timestamp': snapshot['timestamp'],
                        'image_base64': snapshot['image_base64'],
                        'context_start': context_start,
                        'context_end': context_end,
                        'context_transcript': context_transcript
                    })

                return segments

            def format_timestamp(seconds: float) -> str:
                '''ç§’ã‚’HH:MM:SSå½¢å¼ã«å¤‰æ›'''
                hours = int(seconds // 3600)
                minutes = int((seconds % 3600) // 60)
                secs = int(seconds % 60)
                return f'{hours:02d}:{minutes:02d}:{secs:02d}'

            def main(snapshots: List[Dict[str, Any]], llm_text: str) -> Dict[str, Any]:
                transcript_entries = parse_transcript(llm_text)
                segments = link_transcript_to_snapshots(snapshots, transcript_entries)

                return {
                    'segments': segments,
                    'transcript_entries': transcript_entries,
                    'full_transcript': llm_text
                }
          outputs:
            - variable: segments
              type: array
              label: ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ
            - variable: transcript_entries
              type: array
              label: Transcriptã‚¨ãƒ³ãƒˆãƒª
            - variable: full_transcript
              type: string
              label: å®Œå…¨ãªæ–‡å­—èµ·ã“ã—
          outputs_mapping: {}
        id: '1770557302878'
        position:
          x: 560
          y: 280
        type: custom

      # Code Node 3: Batch Splitting
      - data:
          type: code
          title: ãƒãƒƒãƒåˆ†å‰²
          code: |
            from typing import Dict, List, Any

            def main(segments: List[Dict[str, Any]], batch_size: int = 16) -> Dict[str, Any]:
                '''ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚’ãƒãƒƒãƒã«åˆ†å‰²ï¼ˆGemini 2.5ã®ç”»åƒåˆ¶é™å¯¾å¿œï¼‰'''
                batches = []

                for i in range(0, len(segments), batch_size):
                    batch = segments[i:i + batch_size]
                    batches.append({
                        'batch_index': len(batches),
                        'segments': batch
                    })

                return {
                    'batches': batches,
                    'total_batches': len(batches),
                    'total_segments': len(segments)
                }
          outputs:
            - variable: batches
              type: array
              label: ãƒãƒƒãƒ
            - variable: total_batches
              type: number
              label: ç·ãƒãƒƒãƒæ•°
            - variable: total_segments
              type: number
              label: ç·ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæ•°
          outputs_mapping: {}
        id: '1770557302978'
        position:
          x: 800
          y: 280
        type: custom

      # Iteration Node
      - data:
          type: iteration
          title: ãƒãƒƒãƒå‡¦ç†
          iterator_selector:
            - '1770557302978'
            - batches
          output_selector:
            - item
          output_type: array
          is_parallel: true
        id: '1770557303078'
        position:
          x: 1040
          y: 280
        type: custom

      # LLM Node 2: Image Analysis (Gemini 2.5 Vision)
      - data:
          type: llm
          title: ç”»åƒåˆ†æ
          model:
            provider: google
            name: gemini-2.5-flash
            mode: chat
            completion_params:
              temperature: 0.5
              max_tokens: 8000
          prompt_template:
            - role: system
              text: |
                ã‚ãªãŸã¯å‹•ç”»ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ†æå°‚é–€å®¶ã§ã™ã€‚æä¾›ã•ã‚ŒãŸç”»åƒã¨æ–‡å­—èµ·ã“ã—ã‹ã‚‰ã€ä»¥ä¸‹ã‚’æŠ½å‡ºã—ã¦ãã ã•ã„ï¼š

                1. **summary**: ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã®è¦ç´„ï¼ˆ3-5æ–‡ï¼‰
                2. **slide_text**: ã‚¹ãƒ©ã‚¤ãƒ‰ã«å«ã¾ã‚Œã‚‹ãƒ†ã‚­ã‚¹ãƒˆï¼ˆOCRã§æŠ½å‡ºï¼‰
                3. **key_points**: é‡è¦ãªãƒã‚¤ãƒ³ãƒˆï¼ˆ3-5ç‚¹ã®ç®‡æ¡æ›¸ãï¼‰
                4. **importance_score**: é‡è¦åº¦ã‚¹ã‚³ã‚¢ï¼ˆ1-10ã€10ãŒæœ€é‡è¦ï¼‰

                å‡ºåŠ›ã¯JSONå½¢å¼ã§è¡Œã£ã¦ãã ã•ã„ï¼š
                ```json
                {
                  "summary": "è¦ç´„...",
                  "slide_text": "ã‚¹ãƒ©ã‚¤ãƒ‰ãƒ†ã‚­ã‚¹ãƒˆ...",
                  "key_points": ["ãƒã‚¤ãƒ³ãƒˆ1", "ãƒã‚¤ãƒ³ãƒˆ2", ...],
                  "importance_score": 8.5
                }
                ```
            - role: user
              text: |
                ä»¥ä¸‹ã®ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚’åˆ†æã—ã¦ãã ã•ã„ã€‚è¤‡æ•°ã®ã‚»ã‚°ãƒ¡ãƒ³ãƒˆãŒå«ã¾ã‚Œã‚‹å ´åˆã¯ã€ãã‚Œãã‚Œã«ã¤ã„ã¦åˆ†æã—ã¦ãã ã•ã„ã€‚

                ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæ•°: {{#1770557303078.item.segments|length#}}

                å„ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã«ã¤ã„ã¦ã€ç”»åƒã¨å¯¾å¿œã™ã‚‹æ–‡å­—èµ·ã“ã—ã‚’åˆ†æã—ã¦JSONå½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚
                å‡ºåŠ›å½¢å¼: {"results": [{"timestamp": ..., "summary": ..., "slide_text": ..., "key_points": [...], "importance_score": ...}, ...]}
          context:
            enabled: false
            variable_selector: []
          vision:
            enabled: true
        id: '1770557303178'
        position:
          x: 1280
          y: 280
        type: custom

      # Code Node 4: Importance Scoring
      - data:
          type: code
          title: é‡è¦åº¦ã‚¹ã‚³ã‚¢è¨ˆç®—
          code: |
            import json
            from typing import Dict, List, Any

            def parse_llm_output(llm_output: str) -> List[Dict[str, Any]]:
                '''LLMå‡ºåŠ›ã‚’ãƒ‘ãƒ¼ã‚¹'''
                try:
                    data = json.loads(llm_output)
                    return data.get('results', [])
                except json.JSONDecodeError:
                    # ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰æƒ…å ±ã‚’æŠ½å‡º
                    return []

            def normalize_importance_scores(results: List[Dict[str, Any]]) -> List[Dict[str, Any]]:
                '''é‡è¦åº¦ã‚¹ã‚³ã‚¢ã‚’æ­£è¦åŒ–ï¼ˆ0-1ï¼‰'''
                if not results:
                    return []

                scores = [r.get('importance_score', 5) for r in results]
                min_score = min(scores)
                max_score = max(scores)

                if max_score == min_score:
                    for r in results:
                        r['normalized_importance'] = 0.5
                else:
                    for r in results:
                        raw_score = r.get('importance_score', 5)
                        normalized = (raw_score - min_score) / (max_score - min_score)
                        r['normalized_importance'] = round(normalized, 3)

                return results

            def main(iteration_item: Dict[str, Any], llm_text: str) -> Dict[str, Any]:
                results = parse_llm_output(llm_text)
                results = normalize_importance_scores(results)

                # é‡è¦ãªã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆï¼ˆæ­£è¦åŒ–ã‚¹ã‚³ã‚¢ > 0.7ï¼‰
                important_segments = [
                    r for r in results
                    if r.get('normalized_importance', 0) > 0.7
                ]

                return {
                    'results': results,
                    'important_segments': important_segments,
                    'batch_index': iteration_item.get('batch_index', 0)
                }
          outputs:
            - variable: results
              type: array
              label: åˆ†æçµæœ
            - variable: important_segments
              type: array
              label: é‡è¦ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ
            - variable: batch_index
              type: number
              label: ãƒãƒƒãƒã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
          outputs_mapping: {}
        id: '1770557303278'
        position:
          x: 1520
          y: 280
        type: custom

      # Code Node 5: Collect Results
      - data:
          type: code
          title: çµæœåé›†
          code: |
            from typing import Dict, List, Any

            def main(all_results: List[Dict[str, Any]], full_transcript: str, video_duration: float, total_segments: int) -> Dict[str, Any]:
                '''å…¨ãƒãƒƒãƒã®çµæœã‚’çµ±åˆ'''
                all_segments = []
                all_important = []

                for result in all_results:
                    all_segments.extend(result.get('results', []))
                    all_important.extend(result.get('important_segments', []))

                # é‡è¦åº¦ã§ã‚½ãƒ¼ãƒˆ
                all_segments.sort(key=lambda x: x.get('importance_score', 0), reverse=True)

                return {
                    'segments': all_segments,
                    'important_segments': all_important,
                    'full_transcript': full_transcript,
                    'metadata': {
                        'video_duration': video_duration,
                        'total_segments': total_segments,
                        'important_count': len(all_important)
                    }
                }
          outputs:
            - variable: segments
              type: array
              label: å…¨ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ
            - variable: important_segments
              type: array
              label: é‡è¦ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ
            - variable: full_transcript
              type: string
              label: å®Œå…¨ãªæ–‡å­—èµ·ã“ã—
            - variable: metadata
              type: object
              label: ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
          outputs_mapping: {}
        id: '1770557303378'
        position:
          x: 1760
          y: 280
        type: custom

      # LLM Node 3: Action Items Extraction
      - data:
          type: llm
          title: ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ æŠ½å‡º
          model:
            provider: google
            name: gemini-2.5-flash
            mode: chat
            completion_params:
              temperature: 0.4
              max_tokens: 4000
          prompt_template:
            - role: system
              text: |
                ã‚ãªãŸã¯ä¼šè­°ã®è­°äº‹éŒ²å°‚é–€å®¶ã§ã™ã€‚æä¾›ã•ã‚ŒãŸæ–‡å­—èµ·ã“ã—ã¨ã‚»ã‚°ãƒ¡ãƒ³ãƒˆè¦ç´„ã‹ã‚‰ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ ã‚’æŠ½å‡ºã—ã¦ãã ã•ã„ã€‚

                ä»¥ä¸‹ã®æƒ…å ±ã‚’ç‰¹å®šã—ã¦ãã ã•ã„ï¼š
                1. **task**: ã‚¿ã‚¹ã‚¯ã®å†…å®¹
                2. **assignee**: æ‹…å½“è€…ï¼ˆç‰¹å®šã§ãã‚‹å ´åˆï¼‰
                3. **deadline**: æœŸé™ï¼ˆè¨€åŠãŒã‚ã‚‹å ´åˆï¼‰
                4. **priority**: å„ªå…ˆåº¦ï¼ˆhigh/medium/lowï¼‰
                5. **context**: ã‚¿ã‚¹ã‚¯ã®èƒŒæ™¯

                å‡ºåŠ›ã¯JSONå½¢å¼ã§è¡Œã£ã¦ãã ã•ã„ï¼š
                ```json
                {
                  "action_items": [
                    {
                      "task": "ã‚¿ã‚¹ã‚¯å†…å®¹",
                      "assignee": "æ‹…å½“è€…å",
                      "deadline": "æœŸé™",
                      "priority": "high",
                      "context": "èƒŒæ™¯"
                    }
                  ]
                }
                ```
            - role: user
              text: |
                ä»¥ä¸‹ã®ä¼šè­°è¨˜éŒ²ã‹ã‚‰ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ ã‚’æŠ½å‡ºã—ã¦ãã ã•ã„ã€‚

                æ–‡å­—èµ·ã“ã—:
                {{#1770557303378.full_transcript#}}

                é‡è¦ãªã‚»ã‚°ãƒ¡ãƒ³ãƒˆ:
                {% for seg in 1770557303378.important_segments %}
                - {{ seg.summary }}
                {% endfor %}
          context:
            enabled: false
            variable_selector: []
          vision:
            enabled: false
        id: '1770557303478'
        position:
          x: 1760
          y: 100
        type: custom

      # If-Else Node: Check Additional Files
      - data:
          type: if-else
          title: è¿½åŠ ãƒ•ã‚¡ã‚¤ãƒ«åˆ¤å®š
          conditions:
            - id: 'has_additional_files'
              variable_selector:
                - '1770557302578'
                - additional_files
              comparison_operator: is not empty
          logical_operator: and
        id: '1770557303679'
        position:
          x: 2000
          y: 280
        type: custom

      # LLM Node 4: Additional Files Analysis
      - data:
          type: llm
          title: è¿½åŠ ãƒ•ã‚¡ã‚¤ãƒ«è§£æ
          model:
            provider: google
            name: gemini-2.5-flash
            mode: chat
            completion_params:
              temperature: 0.5
              max_tokens: 8000
          prompt_template:
            - role: system
              text: |
                ã‚ãªãŸã¯æä¾›ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆã‚¹ãƒ©ã‚¤ãƒ‰ã€ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆç­‰ï¼‰ã®å†…å®¹ã‚’è¦ç´„ãƒ»åˆ†æã™ã‚‹å°‚é–€å®¶ã§ã™ã€‚
                å„ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¤ã„ã¦ä»¥ä¸‹ã‚’æŠ½å‡ºã—ã¦ãã ã•ã„ï¼š
                1. **filename**: ãƒ•ã‚¡ã‚¤ãƒ«å
                2. **file_type**: ãƒ•ã‚¡ã‚¤ãƒ«ã‚¿ã‚¤ãƒ—ï¼ˆslide, spreadsheet, document, image, otherï¼‰
                3. **content_summary**: ä¸»è¦ãªå†…å®¹ã®è¦ç´„
                4. **key_points**: ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒˆï¼ˆ3-5ç‚¹ï¼‰
                5. **related_topic**: ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®ã©ã®è©±é¡Œã«é–¢é€£ã™ã‚‹ã‹æ¨æ¸¬
                6. **data_extracted**: æŠ½å‡ºã•ã‚ŒãŸé‡è¦ãªãƒ‡ãƒ¼ã‚¿ï¼ˆæ•°å€¤ã€çµ±è¨ˆç­‰ï¼‰

                å‡ºåŠ›ã¯JSONå½¢å¼ã§è¡Œã£ã¦ãã ã•ã„ï¼š
                ```json
                {
                  "additional_files": [
                    {
                      "filename": "sales_data.xlsx",
                      "file_type": "spreadsheet",
                      "content_summary": "Q4å£²ä¸Šãƒ‡ãƒ¼ã‚¿",
                      "key_points": ["å£²ä¸Šå¢—åŠ 20%", "æ–°è¦é¡§å®¢ç²å¾—"],
                      "related_topic": "å£²ä¸Šå ±å‘Š",
                      "data_extracted": {"q4_sales": "1.2å„„å††", "growth": "+20%"}
                    }
                  ]
                }
                ```
            - role: user
              text: |
                ä»¥ä¸‹ã®è¿½åŠ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ†æã—ã¦ãã ã•ã„ã€‚

                ãƒ•ã‚¡ã‚¤ãƒ«æ•°: {{#1770557302578.additional_files|length#}}

                ãƒ•ã‚¡ã‚¤ãƒ«èª¬æ˜:
                {{#1770557302578.file_descriptions#}}

                å„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ†æã—ã¦ã€JSONå½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚
          context:
            enabled: false
            variable_selector: []
          vision:
            enabled: true
        id: '1770557303680'
        position:
          x: 2240
          y: 160
        type: custom

      # LLM Node 5: Fact Verification and Enhancement
      - data:
          type: llm
          title: äº‹å®Ÿç¢ºèªãƒ»ç²¾åº¦å‘ä¸Š
          model:
            provider: google
            name: gemini-2.5-flash
            mode: chat
            completion_params:
              temperature: 0.3
              max_tokens: 12000
          prompt_template:
            - role: system
              text: |
                ã‚ãªãŸã¯å‹•ç”»ã®è¦ç´„çµæœã¨è¿½åŠ ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’ç…§åˆã—ã€äº‹å®Ÿç¢ºèªãƒ»ç²¾åº¦å‘ä¸Šã‚’è¡Œã†å°‚é–€å®¶ã§ã™ã€‚

                ä»¥ä¸‹ã‚’è¡Œã£ã¦ãã ã•ã„ï¼š
                1. è¦ç´„å†…å®¹ãŒè¿½åŠ ãƒ•ã‚¡ã‚¤ãƒ«ã¨ä¸€è‡´ã—ã¦ã„ã‚‹ã‹ç¢ºèª
                2. è¿½åŠ ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰æ–°ãŸãªæƒ…å ±ã‚’æŠ½å‡º
                3. è¦ç´„ã‚’è£œå®Œãƒ»ä¿®æ­£
                4. æ¤œè¨¼æ¸ˆã¿æƒ…å ±ã«ä¿¡é ¼åº¦ãƒ¬ãƒ™ãƒ«ã‚’ä»˜ä¸ï¼ˆhigh/medium/lowï¼‰

                å‡ºåŠ›ã¯JSONå½¢å¼ã§è¡Œã£ã¦ãã ã•ã„ï¼š
                ```json
                {
                  "verification_results": [
                    {
                      "segment_id": 1,
                      "original": "å£²ä¸ŠãŒå¢—åŠ ã—ãŸ",
                      "verified": "å£²ä¸ŠãŒ20%å¢—åŠ ã—ãŸï¼ˆQ4å£²ä¸Šã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚ˆã‚Šç¢ºèªï¼‰",
                      "confidence": "high",
                      "source": "sales_data.xlsx"
                    }
                  ],
                  "additional_info": [
                    {
                      "topic": "å£²ä¸Šå ±å‘Š",
                      "info": "å…·ä½“çš„ãªå£²ä¸Šæ•°å€¤: 1.2å„„å††",
                      "source": "sales_data.xlsx"
                    }
                  ],
                  "corrections": [
                    {
                      "segment_id": 3,
                      "original": "æ–°è¦é¡§å®¢5äºº",
                      "corrected": "æ–°è¦é¡§å®¢50äºº",
                      "reason": "ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãä¿®æ­£"
                    }
                  ]
                }
                ```
            - role: user
              text: |
                å…ƒã®è¦ç´„çµæœã¨è¿½åŠ ãƒ•ã‚¡ã‚¤ãƒ«ã®åˆ†æçµæœã‚’ç…§åˆã—ã¦ãã ã•ã„ã€‚

                å…ƒã®è¦ç´„çµæœï¼ˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆï¼‰:
                {% for seg in 1770557303378.segments %}
                ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ{{ loop.index }} ({{ seg.timestamp }}ç§’):
                è¦ç´„: {{ seg.summary }}
                ã‚¹ãƒ©ã‚¤ãƒ‰ãƒ†ã‚­ã‚¹ãƒˆ: {{ seg.slide_text if seg.slide_text else 'ãªã—' }}
                ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒˆ: {{ seg.key_points | join(', ') }}
                {% endfor %}

                è¿½åŠ ãƒ•ã‚¡ã‚¤ãƒ«ã®åˆ†æçµæœ:
                {{#1770557303680.text#}}

                ã“ã‚Œã‚‰ã‚’çµ±åˆã—ã¦ã€ã‚ˆã‚Šæ­£ç¢ºãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹ãŸã‚ã®æ¤œè¨¼çµæœã‚’å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚
          context:
            enabled: false
            variable_selector: []
          vision:
            enabled: false
        id: '1770557303681'
        position:
          x: 2480
          y: 160
        type: custom

      # Template Transform Beta: Final Output with Verification
      - data:
          type: template-transform
          title: æœ€çµ‚å‡ºåŠ›ç”Ÿæˆï¼ˆBetaç‰ˆãƒ»æ¤œè¨¼æ¸ˆã¿ï¼‰
          template: |
            # å‹•ç”»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆæ¤œè¨¼æ¸ˆã¿ç‰ˆï¼‰

            ## ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿

            - å‹•ç”»é•·: `{{ format_duration(1770557303378.metadata.video_duration) }}`
            - ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæ•°: `{{ 1770557303378.metadata.total_segments }}`
            - é‡è¦ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ: `{{ 1770557303378.metadata.important_count }}`
            - æ¤œè¨¼æ¸ˆã¿: `âœ“ è¿½åŠ ãƒ•ã‚¡ã‚¤ãƒ«ã«åŸºã¥ãäº‹å®Ÿç¢ºèªå®Œäº†`

            ---

            ## è¿½åŠ ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±

            {% if 1770557303680.additional_files %}
            {% for file in 1770557303680.additional_files %}
            ### {{ file.filename }}

            - **ãƒ•ã‚¡ã‚¤ãƒ«ã‚¿ã‚¤ãƒ—**: {{ file.file_type }}
            - **é–¢é€£ãƒˆãƒ”ãƒƒã‚¯**: {{ file.related_topic }}
            - **å†…å®¹è¦ç´„**: {{ file.content_summary }}
            - **ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒˆ**:
            {% for point in file.key_points %}
              - {{ point }}
            {% endfor %}
            {% if file.data_extracted %}
            - **æŠ½å‡ºãƒ‡ãƒ¼ã‚¿**: {{ file.data_extracted }}
            {% endif %}

            {% endfor %}
            {% endif %}

            ---

            ## ç›®æ¬¡

            {% for seg in 1770557303378.segments %}
            {{ loop.index }}. [{{ format_timestamp(seg.timestamp) }}] {% if seg.slide_text %}{{ seg.slide_text[:50] }}{% else %}ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ {{ loop.index }}{% endif %}
            {% endfor %}

            ---

            ## ã‚»ã‚°ãƒ¡ãƒ³ãƒˆè©³ç´°ï¼ˆæ¤œè¨¼æ¸ˆã¿ï¼‰

            {% for seg in 1770557303378.segments %}
            ### {{ loop.index }}. {{ format_timestamp(seg.timestamp) }} {% if seg.normalized_importance > 0.7 %}â­ é‡è¦{% endif %}

            **é‡è¦åº¦**: `{{ seg.importance_score }}/10`

            {% if seg.slide_text %}
            **ã‚¹ãƒ©ã‚¤ãƒ‰ãƒ†ã‚­ã‚¹ãƒˆ**:
            {{ seg.slide_text }}
            {% endif %}

            **è¦ç´„**:
            {{ seg.summary }}

            {% if 1770557303681.verification_results %}
            {% for vr in 1770557303681.verification_results %}
            {% if vr.segment_id == loop.index %}
            **âœ“ æ¤œè¨¼æ¸ˆã¿æƒ…å ±** (ä¿¡é ¼åº¦: {{ vr.confidence }}):
            {{ vr.verified }}
            *å‡ºå…¸: {{ vr.source }}*
            {% endif %}
            {% endfor %}
            {% endif %}

            **ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒˆ**:
            {% for point in seg.key_points %}
            - {{ point }}
            {% endfor %}

            ---

            {% endfor %}

            ## è¿½åŠ æƒ…å ±ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰æŠ½å‡ºï¼‰

            {% if 1770557303681.additional_info %}
            {% for info in 1770557303681.additional_info %}
            ### {{ info.topic }}

            {{ info.info }}
            *å‡ºå…¸: {{ info.source }}*

            {% endfor %}
            {% else %}
            è¿½åŠ ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã®æ–°è¦æƒ…å ±ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚
            {% endif %}

            ---

            ## ä¿®æ­£å±¥æ­´

            {% if 1770557303681.corrections %}
            {% for corr in 1770557303681.corrections %}
            ### ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ{{ corr.segment_id }}ã®ä¿®æ­£

            - **å…ƒã®å†…å®¹**: {{ corr.original }}
            - **ä¿®æ­£å†…å®¹**: {{ corr.corrected }}
            - **ç†ç”±**: {{ corr.reason }}

            {% endfor %}
            {% else %}
            ä¿®æ­£ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚
            {% endif %}

            ---

            ## ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ 

            {% if 1770557303478.action_items %}
            {% for item in 1770557303478.action_items %}
            ### {{ item.task }}

            - **æ‹…å½“è€…**: {{ item.assignee if item.assignee else 'TBD' }}
            - **æœŸé™**: {{ item.deadline if item.deadline else 'æœªå®š' }}
            - **å„ªå…ˆåº¦**: {{ item.priority }}
            - **èƒŒæ™¯**: {{ item.context }}

            {% endfor %}
            {% else %}
            ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚
            {% endif %}

            ---

            ## å®Œå…¨ãªæ–‡å­—èµ·ã“ã—

            {{ 1770557303378.full_transcript }}
          output_type: string
          variables: []
        id: '1770557303682'
        position:
          x: 2720
          y: 160
        type: custom

      # Template Transform: Final Output (Original)
      - data:
          type: template-transform
          title: æœ€çµ‚å‡ºåŠ›ç”Ÿæˆï¼ˆé€šå¸¸ç‰ˆï¼‰
          template: |
            # å‹•ç”»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

            ## ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿

            - å‹•ç”»é•·: `{{ format_duration(1770557303378.metadata.video_duration) }}`
            - ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæ•°: `{{ 1770557303378.metadata.total_segments }}`
            - é‡è¦ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ: `{{ 1770557303378.metadata.important_count }}`

            ---

            ## ç›®æ¬¡

            {% for seg in 1770557303378.segments %}
            {{ loop.index }}. [{{ format_timestamp(seg.timestamp) }}] {% if seg.slide_text %}{{ seg.slide_text[:50] }}{% else %}ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ {{ loop.index }}{% endif %}
            {% endfor %}

            ---

            ## ã‚»ã‚°ãƒ¡ãƒ³ãƒˆè©³ç´°

            {% for seg in 1770557303378.segments %}
            ### {{ loop.index }}. {{ format_timestamp(seg.timestamp) }} {% if seg.normalized_importance > 0.7 %}â­ é‡è¦{% endif %}

            **é‡è¦åº¦**: `{{ seg.importance_score }}/10`

            {% if seg.slide_text %}
            **ã‚¹ãƒ©ã‚¤ãƒ‰ãƒ†ã‚­ã‚¹ãƒˆ**:
            {{ seg.slide_text }}
            {% endif %}

            **è¦ç´„**:
            {{ seg.summary }}

            **ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒˆ**:
            {% for point in seg.key_points %}
            - {{ point }}
            {% endfor %}

            ---

            {% endfor %}

            ## ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ 

            {% if 1770557303478.action_items %}
            {% for item in 1770557303478.action_items %}
            ### {{ item.task }}

            - **æ‹…å½“è€…**: {{ item.assignee if item.assignee else 'TBD' }}
            - **æœŸé™**: {{ item.deadline if item.deadline else 'æœªå®š' }}
            - **å„ªå…ˆåº¦**: {{ item.priority }}
            - **èƒŒæ™¯**: {{ item.context }}

            {% endfor %}
            {% else %}
            ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚
            {% endif %}

            ---

            ## å®Œå…¨ãªæ–‡å­—èµ·ã“ã—

            {{ 1770557303378.full_transcript }}
          output_type: string
          variables: []
        id: '1770557303578'
        position:
          x: 2240
          y: 400
        type: custom

      # End Node
      - data:
          type: end
          variables:
            - variable: '1770557303578.output'
              label: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
            - variable: '1770557303682.output'
              label: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆæ¤œè¨¼æ¸ˆã¿ç‰ˆï¼‰
            - variable: '1770557303378.important_segments'
              label: é‡è¦ã‚»ã‚°ãƒ¡ãƒ³ãƒˆä¸€è¦§
            - variable: '1770557303478.action_items'
              label: ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ 
            - variable: '1770557303681.verification_results'
              label: æ¤œè¨¼çµæœ
        id: '1770557303678'
        position:
          x: 2960
          y: 280
        type: custom
